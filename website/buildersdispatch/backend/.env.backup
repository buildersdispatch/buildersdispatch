#!/bin/bash
# BuildersDispatch Environment Configuration
# This file contains all environment variables for the system

#============================================
# SERVER CONFIGURATION
#============================================
export SERVER_IP="72.60.117.91"
export NODE_ENV="staging"
export PORT="3000"
export XASIX_PORT="3001"

#============================================
# DOMAIN CONFIGURATION
#============================================
export DOMAIN_BUILDERSDISPATCH="buildersdispatch.com"
export DOMAIN_XASIX="xasix.com"

#============================================
# CROSSMINT CONFIGURATION (STAGING)
#============================================
export CROSSMINT_API_VERSION="2025-06-09"
export CROSSMINT_BASE_URL="https://staging.crossmint.com/api/2025-06-09"
export CROSSMINT_PROJECT_ID="2ba5d2cd-c795-4b51-89e3-72044c720265"

# Server-side API Key (NEVER expose to frontend)
export CROSSMINT_SERVER_KEY="sk_staging_22vKioqJrmY2W24vfGPdkhCrouSUJoSmzgrDAhrjKiyTuy7xVozuBsH4sEAAh4SBeaaLrW7bqEvNL46jXvet5k3NKLox9YGSry5P69BoJZ3wMQ4WMArzJFkVoNWSzaEKoje2ufV7862Wu7PL2HCiuF8bZCqQmoVWs6eBKRHJMugXsisvkoBf9ZbTms8wiRDaGFE14nUiVVgaWvzWFdiY2nB"
CHANGE_ME_STRONG_PASSWORD_HERE
# Client-side API Key (safe for frontend)
export CROSSMINT_CLIENT_KEY="ck_staging_5ZUMdXiDpfZwd5iKqtvuDrTLr2TRXZzmbctChqLVoeGDnnhhxASbgPCcvLd2waxYPsRNhb6oRjk5oTKjmPyRoeVKH75Jpw1NE6K5yUn2kYj8Dh7MpwLxy6ik8ZHLuR7WuNnwNW9TXiMYbdnCF1xbutz63DEU5T8G9in7VMjqoD37odcKx4fdxehSkhMNMy25LTeQ6NPdekUb69V5WdusMr1i"

# Blockchain Configuration
export CROSSMINT_CHAIN_TYPE="evm"
export CROSSMINT_CHAIN="polygon-amoy"  # Testnet for staging
export CROSSMINT_CHAIN_PRODUCTION="polygon"  # For production switch

# Webhook Configuration (will be set after deployment)
export CROSSMINT_WEBHOOK_SECRET="whsec_PLACEHOLDER"  # Update after deployment

#============================================
# DATABASE CONFIGURATION
#============================================
export DB_HOST="localhost"
export DB_PORT="5432"
export DB_NAME="buildersdispatch"
export DB_USER="bduser"
export DB_PASSWORD="#Password1962"

#============================================
# JWT & SECURITY
#============================================
export JWT_SECRET="8f3b2a9e7c1d5f4a6b8e2c9d7a3f1e5b9c4d6a8f2e7b1c5d3a9f8e2b7c4d6a1f"  # CHANGE THIS!
export SESSION_SECRET="2d5f8a3e9b7c1d6f4a8e2b9c7d5a3f1e8b4c6d9a2f7e1b5c8d3a6f9e2b4c7d"  # CHANGE THIS!
export BCRYPT_ROUNDS="12"

#============================================
# ADMIN ACCOUNT
#============================================
export ADMIN_EMAIL="admin@buildersdispatch.com"
export ADMIN_PASSWORD="#Password1962"  # CHANGE THIS!

#============================================
# EMAIL CONFIGURATION (Optional - for notifications)
#============================================
export SMTP_HOST="smtp.hostinger.com"
export SMTP_PORT="587"
export SMTP_SECURE="false"
export SMTP_USER="noreply@buildersdispatch.com"  # Set up in Hostinger
export SMTP_PASSWORD=""  # Add if configured
export EMAIL_FROM="BuildersDispatch <noreply@buildersdispatch.com>"

#============================================
# N8N CONFIGURATION
#============================================
export N8N_HOST="localhost"
export N8N_PORT="5678"
export N8N_PROTOCOL="http"
export N8N_BASIC_AUTH_ACTIVE="true"
export N8N_BASIC_AUTH_USER="admin"
export N8N_BASIC_AUTH_PASSWORD="#Password1962"  # CHANGE THIS!

#============================================
# FILE STORAGE
#============================================
export UPLOAD_DIR="/var/www/buildersdispatch/uploads"
export MAX_FILE_SIZE="10485760"  # 10MB in bytes

#============================================
# IPFS CONFIGURATION (via Pinata for NFT metadata)
#============================================
export PINATA_API_KEY=""  # Optional - get from pinata.cloud
export PINATA_SECRET_KEY=""
export PINATA_JWT=""

#============================================
# LOGGING
#============================================
export LOG_LEVEL="info"
export LOG_FILE="/var/log/buildersdispatch/app.log"
export LOG_MAX_SIZE="10m"
export LOG_MAX_FILES="10"

#============================================
# RATE LIMITING
#============================================
export RATE_LIMIT_WINDOW="15"  # minutes
export RATE_LIMIT_MAX_REQUESTS="100"

#============================================
# CORS CONFIGURATION
#============================================
export CORS_ORIGIN="https://buildersdispatch.com,https://www.buildersdispatch.com,https://xasix.com,https://www.xasix.com"

#============================================
# PRODUCT CONFIGURATION DEFAULTS
#============================================
export DEFAULT_CURRENCY="USD"
export DEFAULT_NFT_STANDARD="ERC-721"
export DEFAULT_WARRANTY_YEARS="5"

#============================================
# PAYMENT SPLIT DEFAULTS (can be overridden per product)
#============================================
export DEFAULT_PLATFORM_FEE_PERCENT="10"  # 10% platform fee

#============================================
# BACKUP CONFIGURATION
#============================================
export BACKUP_DIR="/var/backups/buildersdispatch"
export BACKUP_RETENTION_DAYS="30"
export BACKUP_TIME="03:00"  # Daily backup at 3 AM

#============================================
# MONITORING
#============================================
export HEALTH_CHECK_INTERVAL="60"  # seconds
export HEALTH_CHECK_ENDPOINT="/api/health"

#============================================
# PRODUCTION SETTINGS (for when you switch)
#============================================
# Uncomment and configure when going to production:
# export NODE_ENV="production"
# export CROSSMINT_BASE_URL="https://www.crossmint.com/api/2025-06-09"
# export CROSSMINT_SERVER_KEY="sk_production_YOUR_PRODUCTION_KEY"
# export CROSSMINT_CLIENT_KEY="ck_production_YOUR_PRODUCTION_KEY"
# export CROSSMINT_CHAIN="polygon"  # Mainnet

#============================================
# NOTES FOR DEPLOYMENT
#============================================
# 1. CHANGE ALL "CHANGE_ME" VALUES BEFORE DEPLOYING!
# 2. Never commit this file with real credentials to public repos
# 3. Use .env.example for version control, keep .env local
# 4. Generate strong passwords: openssl rand -base64 32
# 5. After deployment, update CROSSMINT_WEBHOOK_SECRET with actual value

echo "Environment configuration loaded for: $NODE_ENV"
echo "BuildersDispatch domain: $DOMAIN_BUILDERSDISPATCH"
echo "Xasix domain: $DOMAIN_XASIX"
echo "Crossmint Project: $CROSSMINT_PROJECT_ID"
